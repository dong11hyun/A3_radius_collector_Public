# 📋 편의점 폐업 검증 시스템 - 테스트 체크리스트

> **목적**: 시스템의 정확성, 성능, 안정성을 종합적으로 검증하기 위한 테스트 가이드

---

## 1. 성능 테스트

### 1.1 API 호출 횟수 측정

| API | 호출 목적 | 예상 호출 수 (영등포구 기준) | 측정 근거 |
|-----|----------|--------------------------|----------|
| **다이소 공식 API** | 다이소 매장 목록 조회 | 1회 | 지역 키워드 1회 검색으로 전체 조회 |
| **카카오 Local API** | 편의점 검색 | ~192회 | 16개 다이소 × 4분면 × 3페이지(최대) |
| **서울시 OpenAPI (휴게음식점)** | 편의점 인허가 조회 | ~10회 | 전체 ~10,000건 / 1,000건씩 페이징 |
| **서울시 OpenAPI (담배소매업)** | 담배소매업 인허가 조회 | ~5회 | 전체 ~5,000건 / 1,000건씩 페이징 |

**측정 방법:**
```python
# 각 커맨드 파일에 카운터 로그 추가
self.stdout.write(f"API 호출 완료: {api_call_count}회")
```

---

### 1.2 실행 시간 측정

**전체 파이프라인 측정:**
```powershell
Measure-Command { docker compose exec web python manage.py run_all --gu 영등포구 }
```

**단계별 예상 시간:**
| 단계 | 예상 시간 | 병목 요인 |
|------|----------|----------|
| 다이소 수집 | 10~20초 | 다이소 API 응답 속도 |
| 편의점 수집 | 60~120초 | 카카오 API Rate Limit (0.2초 딜레이) |
| 휴게음식점 인허가 | 30~60초 | 대용량 데이터 페이징 |
| 담배소매업 인허가 | 20~40초 | 대용량 데이터 페이징 |
| 폐업 검증 | 5~10초 | CSV 파싱 및 매칭 로직 |
| **총합** | **약 3~5분** | - |

---

### 1.3 Docker 컨테이너 리소스

**실시간 모니터링:**
```powershell
docker stats
```

**예상 리소스 사용량:**
| 컨테이너 | CPU | 메모리 | 근거 |
|---------|-----|-------|------|
| web | 10~30% | 200~400MB | Django + 데이터 처리 |
| db | 5~15% | 100~200MB | PostgreSQL 쿼리 처리 |

---

### 1.4 브라우저 개발자도구 (F12)

| 탭 | 확인 항목 | 체크 방법 |
|----|---------|----------|
| **Network** | API 응답 시간, 데이터 크기 | `/api/check-status/` 폴링 확인 |
| **Performance** | 프레임 속도 (60fps 목표) | 마커 렌더링 시 측정 |
| **Memory** | 힙 메모리 사용량 | 마커 100개당 ~1-2MB |
| **Console** | JavaScript 에러 | 빨간색 에러 메시지 없어야 함 |

---

## 2. 데이터 품질 검증

### 2.1 정확도 테스트

| 테스트 | 방법 | 성공 기준 |
|--------|------|----------|
| **폐업 매장 실제 확인** | 폐업 추정 매장 5~10개 로드뷰/직접 확인 | 80% 이상 실제 폐업 |
| **정상 매장 오분류** | 정상 표시 매장 샘플 확인 | 95% 이상 실제 영업 중 |
| **다이소 누락 확인** | 다이소몰 공식 vs 수집 수 비교 | 100% 일치 |

**근거**: 공공데이터와 교차 검증하므로 높은 정확도 기대, 다만 공공데이터 업데이트 주기에 따라 오차 발생 가능

---

### 2.2 데이터 커버리지

**좌표 누락 비율 확인:**
```sql
SELECT 
    COUNT(*) as total,
    SUM(CASE WHEN location IS NULL THEN 1 ELSE 0 END) as no_coords,
    ROUND(SUM(CASE WHEN location IS NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 2) as pct
FROM yeongdeungpo_convenience;
```

**성공 기준**: 좌표 누락률 5% 이하

---

### 2.3 데이터 일관성

**중복 데이터 확인:**
```sql
SELECT place_id, COUNT(*) as cnt 
FROM yeongdeungpo_convenience 
GROUP BY place_id 
HAVING COUNT(*) > 1;
```

**폐업 검증 결과 일치 확인:**
```sql
SELECT 
    (SELECT COUNT(*) FROM yeongdeungpo_convenience) as convenience_count,
    (SELECT COUNT(*) FROM store_closure_result) as closure_result_count;
```

**성공 기준**: 중복 0개, 편의점 수 = 검증 결과 수

---

## 3. 확장성 테스트

### 3.1 다른 구 비교

| 구 | 예상 다이소 | 예상 편의점 | 테스트 포인트 |
|----|-----------|------------|--------------|
| 영등포구 | 16개 | 463개 | 기준 데이터 |
| 강남구 | 25개+ | 600개+ | 밀집 지역 |
| 중구 | 10개~ | 300개~ | 상권 밀집 |
| 도봉구 | 8개~ | 200개~ | 인구 적은 지역 |

**성공 기준**: 모든 구에서 에러 없이 수집 완료

---

### 3.2 밀집 지역 테스트

**테스트 목적**: 45개 API 제한 돌파 확인

| 지역 | 예상 편의점 수 | 4분면 분할 효과 |
|------|--------------|----------------|
| 강남역 주변 | 50개+ | 4분면 분할로 전수 조사 가능 |
| 홍대입구 | 40개+ | 4분면 분할로 전수 조사 가능 |

**확인 방법**: 네이버/카카오맵 육안 카운트 vs 수집 데이터 비교

---

### 3.3 경계 지역 정확성

**테스트**: 구 경계에 있는 편의점이 올바른 구에 할당되는지

**확인 방법:**
```python
# 주소에 target_gu가 포함되는지 확인
def is_target_gu(address, target_gu):
    return target_gu in address
```

**성공 기준**: 다른 구 데이터 혼입 0%

---

## 4. 예외 처리 테스트

| 시나리오 | 테스트 방법 | 예상 동작 | 성공 기준 |
|----------|------------|----------|----------|
| **잘못된 API 키** | 틀린 키 입력 후 수집 | 에러 메시지 표시 | 명확한 에러 문구 |
| **네트워크 끊김** | 수집 중 Wi-Fi 끄기 | 타임아웃 에러 | 무한 대기 없음 |
| **빈 결과** | 존재하지 않는 키워드 검색 | 0개 결과 처리 | 크래시 없음 |
| **중복 실행** | 수집 버튼 연속 2회 클릭 | 중복 방지 | "이미 진행 중" 메시지 |
| **브라우저 새로고침** | 수집 중 F5 | 상태 확인 가능 | 진행 상태 표시 |

---

## 5. 비용 분석

### 5.1 API 비용

| API | 무료 한도 | 수집 1회 사용량 | 일일 가능 횟수 |
|-----|----------|----------------|--------------|
| **카카오 API** | 무제한 (초당 10회) | ~200회 | 무제한 |
| **서울시 OpenAPI** | 일 10,000회 | ~15회 | ~660회 |
| **다이소 공식 API** | 비공식 (무제한) | 1회 | 무제한 |

### 5.2 서버 비용 (배포 시)

| 플랫폼 | 스펙 | 월 비용 |
|--------|------|--------|
| **로컬 Docker** | 개발용 | 무료 |
| **AWS EC2 t3.micro** | 1 vCPU, 1GB RAM | ~$8/월 |
| **Railway** | 512MB RAM | 무료 (500시간/월) |
| **Render** | 512MB RAM | 무료 (750시간/월) |

---

## 6. 시각화 검증

| 항목 | 체크 방법 | 성공 기준 |
|------|----------|----------|
| **마커 색상 구분** | 육안 확인 | 정상=파랑, 폐업=빨강 명확히 구분 |
| **마커 겹침** | 밀집 지역 줌인 | 개별 마커 클릭 가능 |
| **인포윈도우** | 마커 클릭 | 매장명, 주소, 상태 정상 표시 |
| **지도 줌 레벨** | 초기 로드 | 전체 구가 화면에 들어옴 |
| **반응형 레이아웃** | 창 크기 조절 | 깨짐 없음 |

---

## 7. 보안 체크

| 항목 | 체크 방법 | 성공 기준 |
|------|----------|----------|
| **API 키 노출** | Network 탭 확인 | 요청 URL에 키 미노출 |
| **localStorage 확인** | Application 탭 | 키 저장 시 민감 정보 인지 |
| **CSRF 토큰** | POST 요청 확인 | 403 에러 없음 |
| **XSS 취약점** | 특수문자 입력 | 스크립트 실행 안됨 |

---

## 8. 문서화/재현성

| 항목 | 체크 방법 | 성공 기준 |
|------|----------|----------|
| **README 정확성** | 새 환경에서 따라하기 | 오류 없이 실행 |
| **Docker 재현성** | 다른 PC에서 실행 | `docker compose up`만으로 동작 |
| **의존성 충돌** | 새 venv에서 설치 | `pip install -r requirements.txt` 성공 |

---

## 📊 테스트 결과 기록 템플릿

```markdown
## 테스트 일시: YYYY-MM-DD HH:MM

### 테스트 환경
- OS: Windows 11
- Docker: v24.x
- Python: 3.11

### 테스트 결과

| 카테고리 | 항목 | 결과 | 비고 |
|---------|------|------|------|
| 성능 | 전체 실행 시간 | 4분 32초 | |
| 성능 | 카카오 API 호출 | 187회 | |
| 데이터 | 편의점 수집 | 463개 | |
| 데이터 | 폐업 추정 | 11개 | |
| 정확도 | 폐업 실제 확인 | 9/10 | 90% 정확 |

### 발견된 이슈
- [ ] 이슈 1
- [ ] 이슈 2
```

---

**작성일**: 2026-01-19  
**버전**: v2.3
