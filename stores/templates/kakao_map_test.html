<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ì¹´ì¹´ì˜¤ ì§€ë„ ë§ˆì»¤ í…ŒìŠ¤íŠ¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            color: #fff;
            text-align: center;
            margin-bottom: 20px;
            font-size: 2rem;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .map-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .map-wrapper {
            flex: 1;
            min-width: 300px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        
        .map-wrapper h2 {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        #map {
            width: 100%;
            height: 500px;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.4);
        }
        
        .info-panel {
            margin-top: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
        }
        
        .info-panel h3 {
            color: #a5b4fc;
            margin-bottom: 10px;
            font-size: 1rem;
        }
        
        .coord-list {
            max-height: 200px;
            overflow-y: auto;
            color: #e0e7ff;
            font-size: 13px;
            line-height: 1.8;
        }
        
        .coord-item {
            padding: 8px 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 6px;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .coord-item:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .badge-daiso {
            background: #fbbf24;
            color: #1a1a2e;
        }
        
        .badge-convenience {
            background: #34d399;
            color: #1a1a2e;
        }
        
        .badge-custom {
            background: #f472b6;
            color: #1a1a2e;
        }
        
        .click-instruction {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.2));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            color: #e0e7ff;
            font-size: 14px;
        }
        
        .click-instruction strong {
            color: #a5b4fc;
        }
        
        .marker-count {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        
        .count-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #e0e7ff;
            font-size: 14px;
        }
        
        .count-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .count-dot.daiso { background: #fbbf24; }
        .count-dot.convenience { background: #34d399; }
        .count-dot.custom { background: #f472b6; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ºï¸ ì¹´ì¹´ì˜¤ ì§€ë„ ë§ˆì»¤ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="map-container">
            <div class="map-wrapper" style="flex: 2;">
                <h2>ğŸ“ ì§€ë„ì—ì„œ í´ë¦­í•˜ì—¬ ë§ˆì»¤ ì¶”ê°€í•˜ê¸°</h2>
                <div id="map"></div>
                
                <div class="controls">
                    <button class="btn btn-primary" onclick="addSampleMarkers()">
                        ğŸ“Œ ìƒ˜í”Œ ë§ˆì»¤ ì¶”ê°€
                    </button>
                    <button class="btn btn-secondary" onclick="loadDBMarkers()">
                        ğŸ—„ï¸ DB ì¢Œí‘œ ë¶ˆëŸ¬ì˜¤ê¸°
                    </button>
                    <button class="btn btn-danger" onclick="clearAllMarkers()">
                        ğŸ—‘ï¸ ëª¨ë“  ë§ˆì»¤ ì‚­ì œ
                    </button>
                </div>
                
                <div class="click-instruction">
                    <strong>ğŸ’¡ ì‚¬ìš©ë²•:</strong> ì§€ë„ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ìœ„ì¹˜ì— ë§ˆì»¤ê°€ ì¶”ê°€ë©ë‹ˆë‹¤. 
                    ìœ„/ê²½ë„ ì¢Œí‘œê°€ ì•„ë˜ ëª©ë¡ì— ìë™ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤.
                </div>
                
                <div class="marker-count">
                    <div class="count-item">
                        <div class="count-dot daiso"></div>
                        <span>ë‹¤ì´ì†Œ: <span id="daisoCount">0</span>ê°œ</span>
                    </div>
                    <div class="count-item">
                        <div class="count-dot convenience"></div>
                        <span>í¸ì˜ì : <span id="convCount">0</span>ê°œ</span>
                    </div>
                    <div class="count-item">
                        <div class="count-dot custom"></div>
                        <span>ì§ì ‘ ì¶”ê°€: <span id="customCount">0</span>ê°œ</span>
                    </div>
                </div>
            </div>
            
            <div class="map-wrapper" style="flex: 1;">
                <h2>ğŸ“‹ ë§ˆì»¤ ì¢Œí‘œ ëª©ë¡</h2>
                <div class="info-panel">
                    <h3>ë“±ë¡ëœ ì¢Œí‘œ</h3>
                    <div class="coord-list" id="coordList">
                        í´ë¦­í•˜ê±°ë‚˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë§ˆì»¤ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì¹´ì¹´ì˜¤ ì§€ë„ API ë¡œë“œ -->
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=7ee7d00aaf0b0a7cc485736b11062173"></script>
    
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let map;
        let markers = [];
        let markerCounts = { daiso: 0, convenience: 0, custom: 0 };
        
        // ë§ˆì»¤ ì´ë¯¸ì§€ URL
        const markerImages = {
            daiso: 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png',
            convenience: 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png',
            custom: 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_number_blue.png'
        };
        
        // ì§€ë„ ì´ˆê¸°í™”
        function initMap() {
            const container = document.getElementById('map');
            const options = {
                center: new kakao.maps.LatLng(37.5219, 126.9245), // ì˜ë“±í¬êµ¬ ì¤‘ì‹¬
                level: 5
            };
            
            map = new kakao.maps.Map(container, options);
            
            // ì§€ë„ íƒ€ì… ì»¨íŠ¸ë¡¤ ì¶”ê°€
            const mapTypeControl = new kakao.maps.MapTypeControl();
            map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);
            
            // ì¤Œ ì»¨íŠ¸ë¡¤ ì¶”ê°€
            const zoomControl = new kakao.maps.ZoomControl();
            map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
            
            // ì§€ë„ í´ë¦­ ì´ë²¤íŠ¸
            kakao.maps.event.addListener(map, 'click', function(mouseEvent) {
                const latlng = mouseEvent.latLng;
                addMarker(latlng.getLat(), latlng.getLng(), 'custom', 'ì§ì ‘ ì¶”ê°€í•œ ìœ„ì¹˜');
            });
            
            console.log('ğŸ—ºï¸ ì¹´ì¹´ì˜¤ ì§€ë„ê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
        
        // ë§ˆì»¤ ì¶”ê°€ í•¨ìˆ˜
        function addMarker(lat, lng, type, title) {
            const position = new kakao.maps.LatLng(lat, lng);
            
            // ë§ˆì»¤ ì´ë¯¸ì§€ ì„¤ì •
            let imageSize, imageSrc;
            if (type === 'daiso') {
                imageSrc = markerImages.daiso;
                imageSize = new kakao.maps.Size(24, 35);
            } else if (type === 'convenience') {
                imageSrc = markerImages.convenience;
                imageSize = new kakao.maps.Size(24, 35);
            } else {
                imageSrc = markerImages.custom;
                imageSize = new kakao.maps.Size(36, 37);
            }
            
            const markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize);
            
            const marker = new kakao.maps.Marker({
                position: position,
                map: map,
                title: title,
                image: markerImage
            });
            
            // ì¸í¬ìœˆë„ìš° ìƒì„±
            const infowindow = new kakao.maps.InfoWindow({
                content: `<div style="padding:10px;font-size:12px;min-width:150px;">
                    <strong>${title}</strong><br>
                    <span style="color:#666;">ìœ„ë„: ${lat.toFixed(6)}</span><br>
                    <span style="color:#666;">ê²½ë„: ${lng.toFixed(6)}</span>
                </div>`
            });
            
            // ë§ˆì»¤ì— ë§ˆìš°ìŠ¤ì˜¤ë²„ ì´ë²¤íŠ¸
            kakao.maps.event.addListener(marker, 'mouseover', function() {
                infowindow.open(map, marker);
            });
            
            kakao.maps.event.addListener(marker, 'mouseout', function() {
                infowindow.close();
            });
            
            // ë§ˆì»¤ ì •ë³´ ì €ì¥
            markers.push({
                marker: marker,
                lat: lat,
                lng: lng,
                type: type,
                title: title
            });
            
            // ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
            markerCounts[type]++;
            updateCounts();
            updateCoordList();
            
            console.log(`ğŸ“ ë§ˆì»¤ ì¶”ê°€: ${title} (${lat.toFixed(6)}, ${lng.toFixed(6)})`);
        }
        
        // ìƒ˜í”Œ ë§ˆì»¤ ì¶”ê°€
        function addSampleMarkers() {
            const sampleLocations = [
                { lat: 37.5245, lng: 126.9010, type: 'daiso', title: 'ë‹¤ì´ì†Œ ì˜ë“±í¬ì ' },
                { lat: 37.5287, lng: 126.9262, type: 'daiso', title: 'ë‹¤ì´ì†Œ ì—¬ì˜ë„ì ' },
                { lat: 37.5165, lng: 126.9079, type: 'convenience', title: 'GS25 ì˜ë“±í¬ì—­ì ' },
                { lat: 37.5198, lng: 126.9305, type: 'convenience', title: 'CU ì—¬ì˜ë„ì—­ì ' },
                { lat: 37.5176, lng: 126.9231, type: 'convenience', title: 'ì„¸ë¸ì¼ë ˆë¸ ë‹¹ì‚°ì ' }
            ];
            
            sampleLocations.forEach(loc => {
                addMarker(loc.lat, loc.lng, loc.type, loc.title);
            });
            
            // ì§€ë„ ë²”ìœ„ ì¡°ì •
            const bounds = new kakao.maps.LatLngBounds();
            markers.forEach(m => {
                bounds.extend(new kakao.maps.LatLng(m.lat, m.lng));
            });
            map.setBounds(bounds);
            
            alert('âœ… 5ê°œì˜ ìƒ˜í”Œ ë§ˆì»¤ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
        
        // DBì—ì„œ ì¢Œí‘œ ë¶ˆëŸ¬ì˜¤ê¸° (Django API ì—°ë™ ì˜ˆì‹œ)
        function loadDBMarkers() {
            // ì‹¤ì œë¡œëŠ” Django APIë¥¼ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤
            // ì—¬ê¸°ì„œëŠ” ì‹œë®¬ë ˆì´ì…˜ì„ ìœ„í•´ í•˜ë“œì½”ë”©ëœ ë°ì´í„° ì‚¬ìš©
            
            alert('ğŸ“¡ DB ì—°ë™ì€ Django ë·°ë¥¼ í†µí•´ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤.\n\n' +
                  'í˜„ì¬ëŠ” ìƒ˜í”Œ ë°ì´í„°ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.\n' +
                  'ì‹¤ì œ êµ¬í˜„ ì‹œ /api/coordinates/ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ìƒì„±í•˜ì„¸ìš”.');
            
            // ìƒ˜í”Œ DB ë°ì´í„° (ì‹¤ì œë¡œëŠ” APIì—ì„œ ê°€ì ¸ì˜´)
            const dbData = [
                // ì˜ë“±í¬êµ¬ ë‹¤ì´ì†Œ ì˜ˆì‹œ
                { lat: 37.5177, lng: 126.9073, type: 'daiso', title: 'DB: ë‹¤ì´ì†Œ ì˜ë“±í¬ë³¸ì ' },
                { lat: 37.5266, lng: 126.9253, type: 'daiso', title: 'DB: ë‹¤ì´ì†Œ ì—¬ì˜ë„ì—­ì ' },
                // ì£¼ë³€ í¸ì˜ì  ì˜ˆì‹œ
                { lat: 37.5180, lng: 126.9080, type: 'convenience', title: 'DB: GS25 ì˜ë“±í¬ì ' },
                { lat: 37.5270, lng: 126.9260, type: 'convenience', title: 'DB: CU ì—¬ì˜ë„ì ' },
            ];
            
            dbData.forEach(loc => {
                addMarker(loc.lat, loc.lng, loc.type, loc.title);
            });
            
            // ì§€ë„ ë²”ìœ„ ì¡°ì •
            if (markers.length > 0) {
                const bounds = new kakao.maps.LatLngBounds();
                markers.forEach(m => {
                    bounds.extend(new kakao.maps.LatLng(m.lat, m.lng));
                });
                map.setBounds(bounds);
            }
        }
        
        // ëª¨ë“  ë§ˆì»¤ ì‚­ì œ
        function clearAllMarkers() {
            markers.forEach(m => {
                m.marker.setMap(null);
            });
            markers = [];
            markerCounts = { daiso: 0, convenience: 0, custom: 0 };
            updateCounts();
            updateCoordList();
            console.log('ğŸ—‘ï¸ ëª¨ë“  ë§ˆì»¤ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
        
        // ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
        function updateCounts() {
            document.getElementById('daisoCount').textContent = markerCounts.daiso;
            document.getElementById('convCount').textContent = markerCounts.convenience;
            document.getElementById('customCount').textContent = markerCounts.custom;
        }
        
        // ì¢Œí‘œ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateCoordList() {
            const listEl = document.getElementById('coordList');
            
            if (markers.length === 0) {
                listEl.innerHTML = 'í´ë¦­í•˜ê±°ë‚˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë§ˆì»¤ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.';
                return;
            }
            
            let html = '';
            markers.forEach((m, idx) => {
                let badgeClass = 'badge-custom';
                if (m.type === 'daiso') badgeClass = 'badge-daiso';
                else if (m.type === 'convenience') badgeClass = 'badge-convenience';
                
                html += `
                    <div class="coord-item">
                        <span>${m.title}</span>
                        <span class="badge ${badgeClass}">${m.lat.toFixed(4)}, ${m.lng.toFixed(4)}</span>
                    </div>
                `;
            });
            
            listEl.innerHTML = html;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì§€ë„ ì´ˆê¸°í™”
        window.onload = initMap;
    </script>
</body>
</html>
